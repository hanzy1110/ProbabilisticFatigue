Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "main.py", line 39, in <module>
    main()
  File "main.py", line 27, in main
    damageCal.restoreFatigueLifeSamples(maxLoads=20)
  File "/home/blueman69/Documents/ProbabilisticFatigue/src/combinedModel.py", line 76, in restoreFatigueLifeSamples
    self.joinAmplitudesStress(maxLoads)
  File "/home/blueman69/Documents/ProbabilisticFatigue/src/combinedModel.py", line 218, in joinAmplitudesStress
    self.SNew = vUnique(self.SNew)
  File "/home/blueman69/anaconda3/envs/dataSc/lib/python3.7/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/blueman69/anaconda3/envs/dataSc/lib/python3.7/site-packages/jax/_src/api.py", line 1488, in vmap_f
    ).call_wrapped(*args_flat)
  File "/home/blueman69/anaconda3/envs/dataSc/lib/python3.7/site-packages/jax/linear_util.py", line 168, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/home/blueman69/Documents/ProbabilisticFatigue/src/combinedModel.py", line 217, in <lambda>
    vUnique = jax.vmap(lambda x: jnp.unique(x).reshape((-1,1)), in_axes=(0,))
  File "/home/blueman69/anaconda3/envs/dataSc/lib/python3.7/site-packages/jax/_src/numpy/setops.py", line 307, in unique
    ar = core.concrete_or_error(None, ar, "The error arose for the first argument of jnp.unique()")
  File "/home/blueman69/anaconda3/envs/dataSc/lib/python3.7/site-packages/jax/core.py", line 1125, in concrete_or_error
    raise ConcretizationTypeError(val, context)
jax._src.traceback_util.UnfilteredStackTrace: jax._src.errors.ConcretizationTypeError: Abstract tracer value encountered where concrete value is expected: Traced<ShapedArray(float32[201])>with<BatchTrace(level=1/0)> with
  val = DeviceArray([[1.5143681e-03, 1.5143681e-03, 3.7517061e-03, ...,
              3.9976054e-01, 4.0199786e-01, 4.0423521e-01],
             [2.5710242e-04, 2.5710242e-04, 2.5909899e-03, ...,
              4.1568908e-01, 4.1802299e-01, 4.2035687e-01],
             [1.4763259e-03, 1.4763259e-03, 3.9734170e-03, ...,
              4.4595852e-01, 4.4845560e-01, 4.5095271e-01],
             ...,
             [2.7242559e-03, 2.7242559e-03, 5.2535860e-03, ...,
              4.5294502e-01, 4.5547435e-01, 4.5800367e-01],
             [1.1612363e-03, 1.1612363e-03, 3.4117375e-03, ...,
              4.0175045e-01, 4.0400097e-01, 4.0625146e-01],
             [1.9224681e-03, 1.9224681e-03, 4.6029654e-03, ...,
              4.7905093e-01, 4.8173141e-01, 4.8441193e-01]],            dtype=float32)
  batch_dim = 0
The error arose for the first argument of jnp.unique()
This Tracer was created on line /home/blueman69/Documents/ProbabilisticFatigue/src/combinedModel.py:218 (joinAmplitudesStress)

See https://jax.readthedocs.io/en/latest/errors.html#jax.errors.ConcretizationTypeError

The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.

--------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/blueman69/anaconda3/envs/dataSc/lib/python3.7/site-packages/pudb/__init__.py", line 148, in runscript
    dbg._runscript(mainpyfile)
  File "/home/blueman69/anaconda3/envs/dataSc/lib/python3.7/site-packages/pudb/debugger.py", line 514, in _runscript
    self.run(statement)
  File "/home/blueman69/anaconda3/envs/dataSc/lib/python3.7/bdb.py", line 578, in run
    exec(cmd, globals, locals)
  File "<string>", line 1, in <module>
  File "main.py", line 39, in <module>
    main()
  File "main.py", line 27, in main
    damageCal.restoreFatigueLifeSamples(maxLoads=20)
  File "/home/blueman69/Documents/ProbabilisticFatigue/src/combinedModel.py", line 76, in restoreFatigueLifeSamples
    self.joinAmplitudesStress(maxLoads)
  File "/home/blueman69/Documents/ProbabilisticFatigue/src/combinedModel.py", line 218, in joinAmplitudesStress
    self.SNew = vUnique(self.SNew)
  File "/home/blueman69/Documents/ProbabilisticFatigue/src/combinedModel.py", line 217, in <lambda>
    vUnique = jax.vmap(lambda x: jnp.unique(x).reshape((-1,1)), in_axes=(0,))
  File "/home/blueman69/anaconda3/envs/dataSc/lib/python3.7/site-packages/jax/_src/numpy/setops.py", line 307, in unique
    ar = core.concrete_or_error(None, ar, "The error arose for the first argument of jnp.unique()")
jax._src.errors.ConcretizationTypeError: Abstract tracer value encountered where concrete value is expected: Traced<ShapedArray(float32[201])>with<BatchTrace(level=1/0)> with
  val = DeviceArray([[1.5143681e-03, 1.5143681e-03, 3.7517061e-03, ...,
              3.9976054e-01, 4.0199786e-01, 4.0423521e-01],
             [2.5710242e-04, 2.5710242e-04, 2.5909899e-03, ...,
              4.1568908e-01, 4.1802299e-01, 4.2035687e-01],
             [1.4763259e-03, 1.4763259e-03, 3.9734170e-03, ...,
              4.4595852e-01, 4.4845560e-01, 4.5095271e-01],
             ...,
             [2.7242559e-03, 2.7242559e-03, 5.2535860e-03, ...,
              4.5294502e-01, 4.5547435e-01, 4.5800367e-01],
             [1.1612363e-03, 1.1612363e-03, 3.4117375e-03, ...,
              4.0175045e-01, 4.0400097e-01, 4.0625146e-01],
             [1.9224681e-03, 1.9224681e-03, 4.6029654e-03, ...,
              4.7905093e-01, 4.8173141e-01, 4.8441193e-01]],            dtype=float32)
  batch_dim = 0
The error arose for the first argument of jnp.unique()
This Tracer was created on line /home/blueman69/Documents/ProbabilisticFatigue/src/combinedModel.py:218 (joinAmplitudesStress)

See https://jax.readthedocs.io/en/latest/errors.html#jax.errors.ConcretizationTypeError
